<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Data Analysis | HTTPLIFE</title>
<meta name=keywords content="Data Analysis,Python,ReactJS"><meta name=description content="Objective The purpose is to provide analysis based on dataset1 provided by going through all the necessary step and methods in this alongside explanation. My project collects data of sales records. I have wrangled and analysed data from last couple years of each country individually and visualized the data in form of excel dashboard for easy understanding of lending trend.
Import && Read Data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import os import pandas as pd import matplotlib."><meta name=author content><link rel=canonical href=https://httplife.com/projects/data-analysis/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://github.com/httplife.png><link rel=icon type=image/png sizes=16x16 href=https://github.com/httplife.png><link rel=icon type=image/png sizes=32x32 href=https://github.com/httplife.png><link rel=apple-touch-icon href=https://github.com/httplife.png><link rel=mask-icon href=https://github.com/httplife.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://httplife.com/projects/data-analysis/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XQ4G79CRDH"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XQ4G79CRDH")}</script><meta property="og:title" content="Data Analysis"><meta property="og:description" content="Objective The purpose is to provide analysis based on dataset1 provided by going through all the necessary step and methods in this alongside explanation. My project collects data of sales records. I have wrangled and analysed data from last couple years of each country individually and visualized the data in form of excel dashboard for easy understanding of lending trend.
Import && Read Data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import os import pandas as pd import matplotlib."><meta property="og:type" content="article"><meta property="og:url" content="https://httplife.com/projects/data-analysis/"><meta property="article:section" content="projects"><meta property="og:site_name" content="HTTPLIFE"><meta name=twitter:card content="summary"><meta name=twitter:title content="Data Analysis"><meta name=twitter:description content="Objective The purpose is to provide analysis based on dataset1 provided by going through all the necessary step and methods in this alongside explanation. My project collects data of sales records. I have wrangled and analysed data from last couple years of each country individually and visualized the data in form of excel dashboard for easy understanding of lending trend.
Import && Read Data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import os import pandas as pd import matplotlib."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"https://httplife.com/projects/"},{"@type":"ListItem","position":2,"name":"Data Analysis","item":"https://httplife.com/projects/data-analysis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Data Analysis","name":"Data Analysis","description":"Objective The purpose is to provide analysis based on dataset1 provided by going through all the necessary step and methods in this alongside explanation. My project collects data of sales records. I have wrangled and analysed data from last couple years of each country individually and visualized the data in form of excel dashboard for easy understanding of lending trend.\nImport \u0026amp;\u0026amp; Read Data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import os import pandas as pd import matplotlib.","keywords":["Data Analysis","Python","ReactJS"],"articleBody":"Objective The purpose is to provide analysis based on dataset1 provided by going through all the necessary step and methods in this alongside explanation. My project collects data of sales records. I have wrangled and analysed data from last couple years of each country individually and visualized the data in form of excel dashboard for easy understanding of lending trend.\nImport \u0026\u0026 Read Data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 import os import pandas as pd import matplotlib.pyplot as plt #find file path directory from dirname, _, filenames in os.walk(\"./source/data\"): for filename in filenames: print(os.path.join(dirname, filename)) all_sales_df = pd.DataFrame() for filename in os.listdir(dir_path): df = pd.read_csv(os.path.join(dirname, filename)) all_sales_df = pd.concat([all_sales_df, df], ignore_index=True) all_sales_df = all_sales_df.rename(mapper = str.strip, axis ='columns') all_sales_df = all_sales_df.rename(columns= {'Order ID': 'Order_id', 'Quantity Ordered': 'Quantity', 'Price Each': 'Price', 'Order Date': 'Date', 'Purchase Address': 'Address'}) #lowercase column name column_name = list(all_sales_df.columns) column_name = [x.lower().strip() for x in column_name] all_sales_df.columns = column_name Data cleaning First check for rows contain null and duplicates. Then check for non-numeric values in order_id, quantity, and price since the 3 column cannot be non-numeric. Then, correct format for each column, Int, Timestamp and String. When there is a few consideration about dropping duplicated rows. Check duplicated rows and their duplicates.\nIf there is null and duplicated rows then it need to be dropped/removed. For non-numeric in mentioned columns, apply to_numeric to remove the rows dataframe. Then check the result by applying the previous methods for a new defined dataframe(clean_sales_df).\nidentify data, null and non-numeric digits 1 2 3 4 5 6 7 8 9 #check for all rows contain null value all_sales_df.isnull().sum() #check duplicated rows all_sales_df.duplicated().sum() #check for non-numeric in order_id, quantity, and price for i in [\"order_id\", \"quantity\", \"price\"]: all_sales_df[i].loc[pd.to_numeric(all_sales_df[i], errors='coerce').isnull()].unique() #check order id in duplicated rows that are not null and is numeric all_sales_df[all_sales_df.duplicated(keep=False) \u0026 all_sales_df['order_id'].notnull() \u0026 all_sales_df['order_id'].str.isnumeric()]['order_id'].head() remove null rows 1 2 3 4 5 #drop null rows clean_sales_df = all_sales_df.dropna(how='all') for i in [\"order_id\", \"quantity\", \"price\"]: clean_sales_df = clean_sales_df[pd.to_numeric(clean_sales_df[i], errors='coerce').notnull()] chagne data type 1 2 3 4 5 6 7 8 9 10 11 12 #change data type for column quantity, price, date, and address clean_sales_df['quantity'] = clean_sales_df['quantity'].astype(int) clean_sales_df['price'] = clean_sales_df['price'].astype(float) clean_sales_df['date'] = pd.to_datetime(clean_sales_df['date'], format='%m/%d/%y %H:%M') clean_sales_df['address'] = clean_sales_df['address'].astype(str) #add city and state column clean_sales_df['city'] = clean_sales_df['address'].apply(lambda x: x.split(',')[1].strip()) clean_sales_df['state'] = clean_sales_df['address'].apply(lambda x: x.split(',')[2].split(' ')[1].strip()) #add total sales column clean_sales_df['total_sales'] = clean_sales_df['quantity'] * clean_sales_df['price'] ** store cleaned dataset to new location **\nQuestions Task 1 Q: What was the best Year for sales? How much was earned that Year? A: Create Annual Sales summary and find max/min values in Annual Sales\nIn this section clean_sales_df will be referred to find annual sales as annual_sales_df. Plot the annual_sales_df and find max/min values in annual_sales_df then print the result as conclusion.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #find annual sales summary and convert to dataframe annual_sales_df = pd.DataFrame(clean_sales_df.groupby(clean_sales_df['date'].dt.year)['total_sales'].sum()) annual_sales_df.reset_index(inplace=True) #generate annual sales visual with plt.style.context('ggplot'): plt.figure(figsize=(4, 4)) sns.barplot(x='date', y='total_sales', data=annual_sales_df) plt.ticklabel_format(style='plain', axis='y') plt.title(\"Annual Sales\", fontsize=20) plt.xlabel(\"Year\") plt.ylabel(\"Sales\") #add data callouts for x, y in enumerate(annual_sales_df['total_sales']): label = f\"${y:,.2f}\" plt.annotate(label, (x,y), textcoords='offset points', xytext=(0,1), ha='center', fontsize=12) plt.show() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #find highest year and value in annual sales highest_year = annual_sales_df['date'].iloc[annual_sales_df['total_sales'].idxmax()] highest_value = annual_sales_df['total_sales'].max() #find lowest year and value in annual sales lowest_year = annual_sales_df['date'].iloc[annual_sales_df['total_sales'].idxmin()] lowest_value = annual_sales_df['total_sales'].min() #show result as visual with plt.style.context('ggplot'): plt.subplots(figsize=(8, 1)) plt.axis('off') plt.text(0.5, 0.5, f\"Highest Year: {highest_year}, Total Sales: ${highest_value:,.2f}\\n\" f\"Lowest Year: {lowest_year}, Total Sales: ${lowest_value:,.2f}\", fontsize=14, ha='center', va='center') plt.title(\"Best \u0026 Worst Year\", fontsize=20) plt.show() 1 2 3 4 5 6 #print result as conclusion print(f\"CONCLUSION\\n\" f\"Total sales generated by company: ${highest_value+lowest_value:,.2f}\\n\" f\"\\n\" f\"With the highest sales is in {highest_year}, generating: ${highest_value:,.2f}\\n\" f\"With the lowest sales is in {lowest_year}, generating: ${lowest_value:,.2f}\") Task 2 Q: What was the best month for sales? How much was earned that month? A: Create Monthly Sales summary and find largest/smallest values in Monthly Sales\nIn this section clean_sales_df will be referred to find monthly sales as monthly_sales_df. Plot the monthly_sales_df and find largest/smallest values in monthly_sales_df then print the result as conclusion.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #find monthly sales summary and convert to dataframe monthly_sales_df = pd.DataFrame(clean_sales_df.groupby([clean_sales_df['date'].dt.year, clean_sales_df['date'].dt.month])['total_sales'].sum()) monthly_sales_df.index = pd.to_datetime(monthly_sales_df.index.map('{0[0]}-{0[1]}'.format)) monthly_sales_df.index.name = 'date' monthly_sales_df = monthly_sales_df.reset_index() #find monthly sales average average_monthly_sales = monthly_sales_df['total_sales'].mean() #generate monthly sales visual with plt.style.context('ggplot'): plt.figure(figsize=(16, 4)) sns.lineplot(x='date', y='total_sales', data=monthly_sales_df) plt.gca().xaxis.set_major_formatter(DateFormatter('%y-%m')) plt.ticklabel_format(style='plain', axis='y') plt.title(\"Monthly Sales\", fontsize=20) plt.xlabel(\"Date\") plt.ylabel(\"Sales\") plt.xticks(monthly_sales_df['date']) #add axh line plt.axhline(y=average_monthly_sales, color='blue', linestyle='--', linewidth=1) plt.text(monthly_sales_df['date'].iloc[-12], average_monthly_sales+5, f\"Avg: ${average_monthly_sales:,.2f}\", color='blue', fontsize=10, ha='center', va='bottom') #add data callouts for x, y in zip(monthly_sales_df['date'], monthly_sales_df['total_sales']): label = f\"${y:,.2f}\" plt.annotate(label, (x,y), textcoords='offset points', xytext=(2,4), ha='center') plt.show() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #find highest month and value in monthly sales highest_months = monthly_sales_df.nlargest(3, 'total_sales') highest_months['date'] = pd.to_datetime(highest_months['date']).dt.strftime('%B %Y') highest_month_names = highest_months['date'].tolist() highest_month_values = highest_months['total_sales'].tolist() #find lowest month and value in monthly sales lowest_months = monthly_sales_df.nsmallest(3, 'total_sales') lowest_months['date'] = pd.to_datetime(lowest_months['date']).dt.strftime('%B %Y') lowest_month_names = lowest_months['date'].tolist() lowest_month_values = lowest_months['total_sales'].tolist() #show result as visual with plt.style.context('ggplot'): plt.subplots(figsize=(8, 1)) plt.axis('off') plt.text(0.5, 0.5, f\"Highest Month: {highest_month_names[0]}, Total Sales: ${highest_month_values[0]:,.2f}\\n\" f\"Lowest Month: {lowest_month_names[0]}, Total Sales: ${lowest_month_values[0]:,.2f}\", fontsize=14, ha='center', va='center') plt.title(\"Best \u0026 Worst Month\", fontsize=20) plt.show() 1 2 3 4 5 #print result as conclusion print(f\"CONCLUSION\\n\" f\"Top 3 best month:\\n{highest_months.to_string(index=False)}\\n\" f\"\\n\" f\"Bottom 3 worst month:\\n{lowest_months.to_string(index=False)}\") Task 3 Q: What City had the highest number of sales? A: Create Sales by State/City and find largest/smallest values in Sales by State/City\nThis section separated by 2 for Sales by State and Sales by City from clean_sales_df. Purpose is to find both trend on state level and city level. Plot and find largest/smallest values in both dataframe then print the result as conclusion.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #find sales by state and convert to dataframe sales_by_state_df = pd.DataFrame(clean_sales_df.groupby('state')['total_sales'].sum()) sales_by_state_df = sales_by_state_df.sort_values(by='total_sales', ascending=False).reset_index() #generate sales by state visual with plt.style.context('fivethirtyeight'): plt.figure(figsize=(16, 4)) sns.barplot(x='state', y='total_sales', data=sales_by_state_df ,palette='husl') plt.ticklabel_format(style='plain', axis='y') plt.title(\"Sales by State\", fontsize=20) plt.xlabel(\"State\") plt.ylabel(\"Sales\") #add data callouts for x, y in enumerate(sales_by_state_df['total_sales']): label = f\"${y:,.2f}\" plt.annotate(label, (x,y), textcoords=\"offset points\", xytext=(0,2), ha='center', fontsize=10) plt.show() 1 2 3 4 5 6 7 8 9 #create dictionary for state colors for use in sales by city visual state_colors = {} n_states = len(sales_by_state_df['state']) palette = sns.color_palette('husl', n_colors=n_states) #use same palette as previous state visual for i, state in enumerate(sales_by_state_df['state']): state_colors[state] = palette[i] #check the state colors print(state_colors) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #find highest month and value in sales by state highest_state = sales_by_state_df.nlargest(3, 'total_sales') highest_state_names = highest_state['state'].tolist() highest_state_values = highest_state['total_sales'].tolist() #find lowest month and value in sales by state lowest_state = sales_by_state_df.nsmallest(3, 'total_sales') lowest_state_names = lowest_state['state'].tolist() lowest_state_values = lowest_state['total_sales'].to_list() #show result as visual with plt.style.context('fivethirtyeight'): plt.subplots(figsize=(8, 1)) plt.axis('off') plt.text(0.5, 0.5, f\"Highest State: {highest_state_names[0]}, Total Sales: ${highest_state_values[0]:,.2f}\\n\" f\"Lowest State: {lowest_state_names[0]}, Total Sales: ${lowest_state_values[0]:,.2f}\", fontsize=14, ha='center', va='center') plt.title(\"Best \u0026 Worst State\", fontsize=20) plt.show() 1 2 3 4 5 6 7 #find sales by city and convert to dataframe sales_by_city_df = pd.DataFrame(clean_sales_df.groupby(['state', 'city'])['total_sales'].sum()) sales_by_city_df = sales_by_city_df.sort_values(by='total_sales', ascending=False).reset_index() #modify city named \"Portland\" before generating visual (to avoid overwrite) sales_by_city_df.loc[(sales_by_city_df['state'] == 'ME') \u0026 (sales_by_city_df['city'] == 'Portland'), 'city'] = 'Portland (Maine)' sales_by_city_df.loc[(sales_by_city_df['state'] == 'OR') \u0026 (sales_by_city_df['city'] == 'Portland'), 'city'] = 'Portland (Oregon)' 1 2 3 4 5 #print result as conclusion print(f\"CONCLUSION\\n\" f\"Top 3 best state sales:\\n{highest_state.to_string(index=False)}\\n\" f\"\\n\" f\"Bottom 3 worst state sales:\\n{lowest_state.to_string(index=False)}\") 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #generate visual for sales by city with plt.style.context('fivethirtyeight'): plt.figure(figsize=(16, 4)) sns.barplot(x='total_sales', y='city', hue='state', data=sales_by_city_df, dodge=False, palette=state_colors) #previous state_colors dict plt.title(\"Sales by City\", fontsize=20) plt.xlabel(\"Sales\") plt.ylabel(\"City\") plt.legend(title=\"State\", bbox_to_anchor=(1.05, 0.5), loc='center left', borderaxespad=0.) #add data callouts for y, x in enumerate(sales_by_city_df['total_sales']): label = f\"${x:,.2f}\" plt.annotate(label, (x, y), textcoords='offset points', xytext=(0, 0), ha='left', va='center', fontsize=10) plt.show() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #find highest month and value in sales by city highest_city = sales_by_city_df.nlargest(3, 'total_sales') highest_city_names = highest_city['city'].tolist() highest_city_values = highest_city['total_sales'].tolist() #find lowest month and value in sales by city lowest_city = sales_by_city_df.nsmallest(3, 'total_sales') lowest_city_names = lowest_city['city'].tolist() lowest_city_values = lowest_city['total_sales'].tolist() #show result as visual with plt.style.context('fivethirtyeight'): plt.subplots(figsize=(8, 1)) plt.axis('off') plt.text(0.5, 0.5, f\"Highest City: {highest_city_names[0]}, Total Sales: ${highest_city_values[0]:,.2f}\\n\" f\"Lowest City: {lowest_city_names[0]}, Total Sales: ${lowest_city_values[0]:,.2f}\", fontsize=14, ha='center', va='center') plt.title(\"Highest \u0026 Lowest City Sales\", fontsize=20) plt.show() 1 2 3 4 5 #print result as conclusion print(f\"CONCLUSION\\n\" f\"Top 3 best city sales:\\n{highest_city.to_string(index=False)}\\n\" f\"\\n\" f\"Bottom 3 worst city sales:\\n{lowest_city.to_string(index=False)}\") Task 4 Q: What time should we display adverstisement to maximize likelihood of customer’s buying product? A: Find Monthly/Daily/Hourly Order Trend\nThis section will find the data related to orders by simply find count/unique number of order_id by month/day/hour. The data that will be referred here is clean_sales_2019_df(which also apply for the rest of the analysis).\nDespite order id cannot be duplicate in the dataset there is multiple rows with the same order id. The reason why it’s not dropped is because each may contains different product. *not sure how to approach/may also need to change data cleaning section\nBut using .count() it will return the duplicated order id as well. If we want to count the order id as unique number then we can call .nunique() which will be used in following sections.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #find monthly order and convert to dataframe monthly_order_df = pd.DataFrame(clean_sales_2019_df.groupby([clean_sales_2019_df['date'].dt.year, clean_sales_2019_df['date'].dt.month])['order_id'].nunique()) monthly_order_df.index = pd.to_datetime(monthly_order_df.index.map('{0[0]}-{0[1]}'.format)) monthly_order_df.index.name = 'date' monthly_order_df = monthly_order_df.rename(columns={'order_id': 'total_orders'}).reset_index() #find average monthly order average_monthly_order = monthly_order_df['total_orders'].mean() #generate monthly order visual with plt.style.context('bmh'): plt.figure(figsize=(16, 4)) sns.lineplot(x='date', y='total_orders', data=monthly_order_df) plt.gca().xaxis.set_major_formatter(DateFormatter('%Y-%m')) plt.ticklabel_format(style='plain', axis='y') plt.title(\"Monthly Order Trend\", fontsize=20) plt.xlabel(\"Date\") plt.ylabel(\"Order\") plt.xticks(monthly_order_df['date']) #add axh line plt.axhline(y=average_monthly_order, color='red', linestyle='--', linewidth=1) plt.text(monthly_order_df['date'].iloc[-12], average_monthly_order+5, f\"Avg: {average_monthly_order:,.2f}\", color='red', fontsize=10, ha='center', va='bottom') #add data callouts for x, y in zip(monthly_order_df['date'], monthly_order_df['total_orders']): label = f\"{(y):,}\" plt.annotate(label, (x,y), textcoords='offset points', xytext=(2,4), ha='center') plt.show() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #find 3 highest value in monthly order highest_monthly_orders = monthly_order_df.nlargest(3, 'total_orders') highest_monthly_orders['date'] = pd.to_datetime(highest_monthly_orders['date']).dt.strftime('%B') #find 3 lowest value in monthly order lowest_monthly_orders = monthly_order_df.nsmallest(3, 'total_orders') lowest_monthly_orders['date'] = pd.to_datetime(lowest_monthly_orders['date']).dt.strftime('%B') #print result as conclusion print(f\"CONCLUSION\\n\" f\"Months with highest total orders:\\n{highest_monthly_orders.to_string(index=False)}\\n\" f\"\\n\" f\"Months with lowest total orders:\\n{lowest_monthly_orders.to_string(index=False)}\\n\" f\"\\n\" f\"*use as references to maximize/prioritize advertisement\") 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #find daily order and convert to dataframe daily_order_df = pd.DataFrame(clean_sales_2019_df.groupby(clean_sales_2019_df['date'].dt.dayofweek)['order_id'].nunique()) daily_order_df.columns = ['total_orders'] daily_order_df.index = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] daily_order_df.index.name = 'day_of_week' daily_order_df = daily_order_df.reset_index() #find average daily order average_daily_order = daily_order_df['total_orders'].mean() #generate daily order visual with plt.style.context('bmh'): plt.figure(figsize=(16, 4)) sns.lineplot(x='day_of_week', y='total_orders', data=daily_order_df) plt.ticklabel_format(style='plain', axis='y') plt.title(\"Daily Order Trend\", fontsize=20) plt.xlabel(\"Day of Week\") plt.ylabel(\"Order\") #add axh line plt.axhline(y=average_daily_order, color='red', linestyle='--', linewidth=1) plt.text(daily_order_df['day_of_week'].iloc[-7], average_daily_order-5, f\"Avg: {average_daily_order:,.2f}\", color='red', fontsize=10, ha='center', va='top') #add data callouts for x, y in enumerate(daily_order_df['total_orders']): label = f\"{(y):,}\" plt.annotate(label, (x,y), textcoords='offset points', xytext=(2,4), ha='center') plt.show() 1 2 3 4 5 6 7 8 9 10 11 12 13 #find 3 highest value in daily orders highest_daily_orders = daily_order_df.nlargest(3, 'total_orders') #find 3 lowest value in daily orders lowest_daily_orders = daily_order_df.nsmallest(3, 'total_orders') #print result as conclusion print(f\"CONCLUSION\\n\" f\"Days with highest total orders:\\n{highest_daily_orders.to_string(index=False)}\\n\" f\"\\n\" f\"Days with lowest total orders:\\n{lowest_daily_orders.to_string(index=False)}\\n\" f\"\\n\" f\"*use as references to maximize/prioritize advertisement\") 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #find hourly order and convert to dataframe hourly_order_df = pd.DataFrame(clean_sales_2019_df.groupby(clean_sales_2019_df['date'].dt.hour)['order_id'].nunique()) hourly_order_df.columns = ['total_orders'] hourly_order_df.index = pd.to_datetime(hourly_order_df.index, format='%H').strftime('%H:%M') hourly_order_df.index.name = 'hour' hourly_order_df = hourly_order_df.reset_index() #find average hourly order average_hourly_order = hourly_order_df['total_orders'].mean() #generate hourly order visual with plt.style.context('bmh'): plt.figure(figsize=(16, 4)) sns.lineplot(x='hour', y='total_orders', data=hourly_order_df) plt.ticklabel_format(style='plain', axis='y') plt.title(\"Hourly Order Trend\", fontsize=20) plt.xlabel(\"Hour\") plt.ylabel(\"Order\") #add axh line plt.axhline(y=average_hourly_order, color='red', linestyle='--', linewidth=2) plt.text(0.5, average_hourly_order+100, f\"Avg: {average_hourly_order:,.2f}\", color='red', fontsize=10, ha='center', va='bottom') #add data callouts for x, y in enumerate(hourly_order_df['total_orders']): label = f\"{y:,}\" plt.annotate(label, (x,y), textcoords='offset points', xytext=(2,4), ha='center') plt.show() 1 2 3 4 5 6 7 8 9 10 11 12 13 #find 6 highest value in hourly orders highest_hourly_orders = hourly_order_df.nlargest(6, 'total_orders') #find 6 lowest value in hourly orders lowest_hourly_orders = hourly_order_df.nsmallest(6, 'total_orders') #print result as conclusion print(f\"CONCLUSION\\n\" f\"Hours with highest total orders:\\n{highest_hourly_orders.to_string(index=False)}\\n\" f\"\\n\" f\"Hours with lowest total orders:\\n{lowest_hourly_orders.to_string(index=False)}\\n\" f\"\\n\" f\"*use as references to maximize/prioritize advertisement\") Task 5 Q: What product sold the most? Why do you think it sold the most? A: Find Products Popularity and Product Price List Comparision\nFind data related to Product Popularity by calculate sum of quantity by each product. This return the total product being purchased. It also find price list by product which is used to create filled lines for comparision.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 #create dataframe for product popularity product_popularity_df = pd.DataFrame(clean_sales_2019_df.groupby('product')['quantity'].sum()) product_popularity_df.index.name = 'product' product_popularity_df = product_popularity_df.sort_values(by='quantity', ascending=False) product_popularity_df = product_popularity_df.reset_index() #create dataframe for product price product_price_df = pd.DataFrame(clean_sales_2019_df.groupby('product')['price'].first()) product_price_df = product_price_df.reset_index() #merge the two dataframes on the product column merged_popularity_price_df = pd.merge(product_popularity_df, product_price_df, on='product') #generate product sales visual with plt.style.context('classic'): fig, ax1 = plt.subplots(figsize=(16, 4)) sns.barplot(x='product', y='quantity', data=merged_popularity_price_df, palette='husl', ax=ax1) plt.ticklabel_format(style='plain', axis='y') plt.title(\"Product Popularity\", fontsize=20) plt.xlabel(\"Product\") plt.ylabel(\"Quantity\") plt.xticks(rotation=80) #add data callouts for x, y in enumerate(merged_popularity_price_df['quantity']): label = f\"{y:,}\" plt.annotate(label, (x,y), textcoords=\"offset points\", xytext=(0,4), ha='center', fontsize=12) #plot product prices as filled line plot ax2 = ax1.twinx() ax2.plot(merged_popularity_price_df['product'], merged_popularity_price_df['price'], color='red') ax2.set_ylabel(\"Price\") ax2.fill_between(merged_popularity_price_df['product'], merged_popularity_price_df['price'], alpha=0.2) plt.show() 1 2 3 4 5 6 7 8 9 #create dictionary for product colors for use in product related visual product_colors = {} n_products = len(merged_popularity_price_df['product']) palette = sns.color_palette('husl', n_colors=n_products) #use same palette as previous product visual for i, product in enumerate(merged_popularity_price_df['product']): product_colors[product] = palette[i] #check the state colors print(product_colors) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #find product sold most product_sold_most = merged_popularity_price_df.nlargest(3, 'quantity') product_sold_most_names = product_sold_most['product'].tolist() product_sold_most_quantities = product_sold_most['quantity'].tolist() #find product sold least product_sold_least = merged_popularity_price_df.nsmallest(3, 'quantity') product_sold_least_names = product_sold_least['product'].tolist() product_sold_least_quantities = product_sold_least['quantity'].tolist() #show result as visual with plt.style.context('classic'): plt.subplots(figsize=(8, 1)) plt.axis('off') plt.text(0.5, 0.5, f\"Most sold: {product_sold_most_names[0]}, Quantity: {product_sold_most_quantities[0]:,}\\n\" f\"Least sold: {product_sold_least_names[0]}, Quantity: {product_sold_least_quantities[0]:,}\", fontsize=14, ha='center', va='center') plt.title(\"Most \u0026 Least Sold Product\", fontsize=20) plt.show() 1 2 3 4 5 #print result as conclusion print(f\"CONCLUSION\\n\" f\"Top 3 most sold products:\\n{product_sold_most.to_string(index=False)}\\n\" f\"\\n\" f\"Bottom 3 least sold products:\\n{product_sold_least.to_string(index=False)}\") 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #find price for each item list product_list_df = pd.DataFrame(clean_sales_2019_df.groupby('product')['price'].first()) product_list_df = product_list_df.sort_values(by='price', ascending=False) product_list_df = product_list_df.reset_index() #find product price average average_product_price = product_list_df['price'].mean() #generate product list visual with plt.style.context('classic'): plt.figure(figsize=(16, 6)) sns.barplot(x='price', y='product', data=product_list_df, palette=product_colors) plt.title(\"Product Price List\", fontsize=20) plt.xlabel(\"Price\") plt.ylabel(\"Product\") #add axv line plt.axvline(x=average_product_price, color='red', linestyle='--', linewidth=1) plt.text(average_product_price+5, len(product_list_df)/2, f\"Avg: ${average_product_price:.2f}\", color='red', ha='left', va='center') plt.show() 1 2 3 4 5 6 7 8 9 10 11 #find expensive product most_expensive_product = product_list_df.nlargest(3, 'price') #find cheap product most_cheap_product = product_list_df.nsmallest(3, 'price') #print result as conclusion print(f\"CONCLUSION\\n\" f\"Most expensive products:\\n{most_expensive_product.to_string(index=False)}\\n\" f\"\\n\" f\"Most cheap products:\\n{most_cheap_product.to_string(index=False)}\") 1 2 3 4 5 6 7 8 9 10 11 12 #find average quantity per order id average_item_per_order = clean_sales_2019_df.groupby('order_id')['quantity'].mean().mean() #show result as visual with plt.style.context('classic'): plt.subplots(figsize=(8, 1)) plt.axis('off') plt.text(0.5, 0.5, f\"{average_item_per_order:,.2f}\", fontsize=40, ha='center', va='center') plt.title(\"Average Item Each Order\", fontsize=20) plt.show() Task 6 Q: How much probability for next people will order certain products? A: Find Product Orders % of Total Sales\nThe following section is to find % product orders/sold compare to the total sales of all products. the result will give % of product which may define the likelihood of the product will be purchased next. This part is also the only section which used Squarify to plot the result as Treemap.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #find total product sold total_product_sold = product_popularity_df['quantity'].sum() #find sizes and labels value in product popularity sizes = product_popularity_df['quantity'] labels = product_popularity_df['product'] #calculate percentage for each product percentages = [f'{100*sizes[i]/sizes.sum():.2f}%\\n{labels[i]}' for i in range(len(sizes))] #generate treemap visual for product sold percentage of total with plt.style.context('seaborn-dark-palette'): plt.figure(figsize=(16, 8)) squarify.plot(sizes=sizes, label=percentages, alpha=0.7, color=[product_colors[label] for label in labels]) #get color from previous product color dict plt.axis('off') plt.title(\"Product % of Total\", fontsize=20) plt.show() 1 2 3 4 5 6 7 8 #print the result as conclusion print(f\"CONCLUSION\\n\" f\"List of probability:\") #find percentages for product and print as conclusion for p in percentages: prob, label = p.split('\\n') print(f\"{label} = {prob}\") Task 7 Q: What products are most often sold together? A: Find Product Associate Rules using mlxtend library\nFirst need to find the product sold by each order id and store them into series(product_by_order). Then transform the data into one-hot encoded matrix by applying TransactionEncoder().fit_transform(). The result will be stored as dataframe(encoded_df). Encoded data then used to generate frequent item sets using apriori algorithm the minimum support are defined as following. Lastly sort the order by value in ‘confidence’.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 #group product by order id product_by_order = clean_sales_2019_df.groupby('order_id')['product'].apply(list) #convert data to one-hot encoded matrix te = TransactionEncoder() onehot = te.fit_transform(product_by_order) encoded_df = pd.DataFrame(onehot, columns=te.columns_) #identify frequent itemsets frequent_itemsets = apriori(encoded_df, min_support=0.000015, use_colnames=True) #generate association rules rules = association_rules(frequent_itemsets, metric='confidence', min_threshold=0.5) rules = rules.sort_values('confidence', ascending=False) #print rules data head rules.head() Although the rules can be presented as tables. In this case the rules is generated as string following more descriptive explanation. There may be other method to visualize the rules waiting to be explored. But for now the following will do.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #create summary for each rule #create list to store items summaries = [] #iterrate throught available items in rules for i, row in rules.iterrows(): antecedents = ', '.join(list(row['antecedents'])) consequents = list(row['consequents'])[0] support = row['support'] confidence = row['confidence'] lift = row['lift'] leverage = row['leverage'] conviction = row['conviction'] #define ANSI escape codes for modifying the text's appearance BLUE = '\\033[94m' GREEN = '\\033[92m' RED = \"\\033[91m\" END = '\\033[0m' #create summary in string summary = ( f\"Rule {i+1}:\\n\" f\"Customers who bought {BLUE}{antecedents}{END} are more likely to buy {RED}{consequents}{END}.\\n\" f\"This combination of products was purchased in {GREEN}{support*100:.3f}%{END} of all transactions.\\n\" f\"When customers buy {BLUE}{antecedents}{END}, the chance of them also buying {RED}{consequents}{END} is {GREEN}{confidence*100:.2f}%{END}.\\n\" f\"{RED}{consequents}{END} appears {GREEN}{lift:.2f}x{END} more likely when {BLUE}{antecedents}{END} appears compared to {RED}{consequents}{END} alone in general.\\n\" f\"The rule's significance, as measured by leverage, is {GREEN}{leverage:.5f}{END}.\\n\" f\"Dependence between {BLUE}{antecedents}{END} and {RED}{consequents}{END} is {GREEN}{conviction:.2f}{END}.\" ) #append the summary summaries.append(summary) #join all summaries into a single string summary_string = \"\\n\\n\".join(summaries) #print summary print(f\"CONCLUSION\\n\\n{summary_string}\") Summarize It appears that the company generated a total of USD 34,465,537.94 in sales, with the majority of sales occurring in 2019, totaling USD 34,456,867.65. In contrast, 2020 only accounted for USD 8,670.29 in sales, which may be due to incomplete or missing data. The highest selling months were December, October, and April 2019, with sales of USD 4,608,295.70, USD 3,734,777.86 and USD 3,389,217.98 respectively, while the lowest sales occurred in January, September 2019, and January 2020, which accounted for only USD 3,915,878.85 of the total sales. The company generated the highest sales in California (CA), with San Francisco and Los Angeles accounting for USD 8,254,743.55 and USD 5,448,304.28 respectively. The lowest sales occurred in Portland, Maine, with only USD 449,321.38 in sales.\nTo maximize the company’s advertising efforts, it is recommended to advertise in December, October, and April, as the company generated the most orders during these months (24,004, 19,436, and 17,528, respectively). Tuesdays were found to be the most profitable day for advertising, generating 26,063 orders, while Fridays had the lowest number of orders. The best times for advertising were between 11:00-13:00 and 18:00-20:00, when the company typically had the highest sales counts.\nIn terms of product performance, some products performed better or worse than their price indicated. The finding result is as following:\nThe Bose SoundSport Headphones had a lower price, but sold less than the Apple Airpods Headphones. The 34in Ultrawide Monitor, 27in 4K Gaming Monitor, Flatscreen TV, 20in Monitor, Vareebadd Phone, LG Washing Machine, and LG Dryer all sold fewer units than the iPhone despite having lower prices. In contrast, the ThinkPad Laptop and Macbook Pro Laptop performed better than expected when compared to the LG Dryer, LG Washing Machine, Vareebadd Phone, and 20in Monitor despite having higher price. The 20in Monitor was the worst-performing product, selling only 4,123 units, compared to the 27in FHD Monitor, which sold 7,538 units despite having lower price. Finally, the probability of customers ordering specific products compared to all other products was calculated as following:\nThe USB-C Charging Cable had the highest probability, with 11.46%. Followed by the Wired Headphones at 9.83%. The iPhone had a probability of 3.28%. While the Google Phone had a probability of 2.65%. Additionally, when customers bought Apple Airpods Headphones, Wired Headphones, and Lightning Charging Cable, the chance of them also buying an iPhone was 100%, but this accounted for only 0.002% of total transactions. Similarly, when customers bought Wired Headphones, USB-C Charging Cable, and Bose SoundSport Headphones, the chance of them also buying a Google Phone was 60%, but this accounted for only 0.002% of total transactions.\nDataset ↩︎\n","wordCount":"3661","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://httplife.com/projects/data-analysis/"},"publisher":{"@type":"Organization","name":"HTTPLIFE","logo":{"@type":"ImageObject","url":"https://github.com/httplife.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://httplife.com/ accesskey=h title="HTTPLIFE (Alt + H)">HTTPLIFE</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://httplife.com/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://httplife.com/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Data Analysis</h1><div class=post-meta></div></header><div class=post-content><h2 id=objective>Objective<a hidden class=anchor aria-hidden=true href=#objective>#</a></h2><p>The purpose is to provide analysis based on dataset<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> provided by going through all the necessary step and methods in this alongside explanation.
My project collects data of sales records. I have wrangled and analysed data from last couple years of each country individually and visualized the data in form of excel dashboard for easy understanding of lending trend.</p><h3 id=import--read-data>Import && Read Data<a hidden class=anchor aria-hidden=true href=#import--read-data>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find file path directory</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dirname</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>filenames</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=s2>&#34;./source/data&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>filenames</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>dirname</span><span class=p>,</span> <span class=n>filename</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>dir_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>dirname</span><span class=p>,</span> <span class=n>filename</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>all_sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>all_sales_df</span><span class=p>,</span> <span class=n>df</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span> <span class=o>=</span> <span class=n>all_sales_df</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>mapper</span> <span class=o>=</span> <span class=nb>str</span><span class=o>.</span><span class=n>strip</span><span class=p>,</span> <span class=n>axis</span> <span class=o>=</span><span class=s1>&#39;columns&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span> <span class=o>=</span> <span class=n>all_sales_df</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span> <span class=p>{</span><span class=s1>&#39;Order ID&#39;</span><span class=p>:</span> <span class=s1>&#39;Order_id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                              <span class=s1>&#39;Quantity Ordered&#39;</span><span class=p>:</span> <span class=s1>&#39;Quantity&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                              <span class=s1>&#39;Price Each&#39;</span><span class=p>:</span> <span class=s1>&#39;Price&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                              <span class=s1>&#39;Order Date&#39;</span><span class=p>:</span> <span class=s1>&#39;Date&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                              <span class=s1>&#39;Purchase Address&#39;</span><span class=p>:</span> <span class=s1>&#39;Address&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#lowercase column name</span>
</span></span><span class=line><span class=cl><span class=n>column_name</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>all_sales_df</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>column_name</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>column_name</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>column_name</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=data-cleaning>Data cleaning<a hidden class=anchor aria-hidden=true href=#data-cleaning>#</a></h3><p>First check for rows contain null and duplicates. Then check for non-numeric values in order_id, quantity, and price since the 3 column cannot be non-numeric. Then, correct format for each column, Int, Timestamp and String. When there is a few consideration about dropping duplicated rows. Check duplicated rows and their duplicates.</p><p>If there is null and duplicated rows then it need to be dropped/removed. For non-numeric in mentioned columns, apply to_numeric to remove the rows dataframe. Then check the result by applying the previous methods for a new defined dataframe(clean_sales_df).</p><h4 id=identify-data-null-and-non-numeric-digits>identify data, null and non-numeric digits<a hidden class=anchor aria-hidden=true href=#identify-data-null-and-non-numeric-digits>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#check for all rows contain null value</span>
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>#check duplicated rows</span>
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span><span class=o>.</span><span class=n>duplicated</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>#check for non-numeric in order_id, quantity, and price</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>,</span> <span class=s2>&#34;quantity&#34;</span><span class=p>,</span> <span class=s2>&#34;price&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>all_sales_df</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>all_sales_df</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;coerce&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>isnull</span><span class=p>()]</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>#check order id in duplicated rows that are not null and is numeric</span>
</span></span><span class=line><span class=cl><span class=n>all_sales_df</span><span class=p>[</span><span class=n>all_sales_df</span><span class=o>.</span><span class=n>duplicated</span><span class=p>(</span><span class=n>keep</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>all_sales_df</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>notnull</span><span class=p>()</span> <span class=o>&amp;</span> <span class=n>all_sales_df</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>isnumeric</span><span class=p>()][</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=remove-null-rows>remove null rows<a hidden class=anchor aria-hidden=true href=#remove-null-rows>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#drop null rows</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span> <span class=o>=</span> <span class=n>all_sales_df</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>how</span><span class=o>=</span><span class=s1>&#39;all&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>,</span> <span class=s2>&#34;quantity&#34;</span><span class=p>,</span> <span class=s2>&#34;price&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>clean_sales_df</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;coerce&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>notnull</span><span class=p>()]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=chagne-data-type>chagne data type<a hidden class=anchor aria-hidden=true href=#chagne-data-type>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#change data type for column quantity, price, date, and address</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>],</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;%m/</span><span class=si>%d</span><span class=s1>/%y %H:%M&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#add city and state column</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#add total sales column</span>
</span></span><span class=line><span class=cl><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>** store cleaned dataset to new location **</p><h3 id=questions>Questions<a hidden class=anchor aria-hidden=true href=#questions>#</a></h3><h4 id=task-1>Task 1<a hidden class=anchor aria-hidden=true href=#task-1>#</a></h4><p>Q: What was the best Year for sales? How much was earned that Year?
A: Create Annual Sales summary and find max/min values in Annual Sales</p><p>In this section clean_sales_df will be referred to find annual sales as annual_sales_df. Plot the annual_sales_df and find max/min values in annual_sales_df then print the result as conclusion.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find annual sales summary and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>annual_sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span><span class=p>)[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>annual_sales_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate annual sales visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;ggplot&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>annual_sales_df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Annual Sales&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Year&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Sales&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;$</span><span class=si>{</span><span class=n>y</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s1>&#39;offset points&#39;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find highest year and value in annual sales</span>
</span></span><span class=line><span class=cl><span class=n>highest_year</span> <span class=o>=</span> <span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>idxmax</span><span class=p>()]</span>
</span></span><span class=line><span class=cl><span class=n>highest_value</span> <span class=o>=</span> <span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find lowest year and value in annual sales</span>
</span></span><span class=line><span class=cl><span class=n>lowest_year</span> <span class=o>=</span> <span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>idxmin</span><span class=p>()]</span>
</span></span><span class=line><span class=cl><span class=n>lowest_value</span> <span class=o>=</span> <span class=n>annual_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#show result as visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;ggplot&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Highest Year: </span><span class=si>{</span><span class=n>highest_year</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>highest_value</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Lowest Year: </span><span class=si>{</span><span class=n>lowest_year</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>lowest_value</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Best &amp; Worst Year&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Total sales generated by company: $</span><span class=si>{</span><span class=n>highest_value</span><span class=o>+</span><span class=n>lowest_value</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;With the highest sales is in </span><span class=si>{</span><span class=n>highest_year</span><span class=si>}</span><span class=s2>, generating: $</span><span class=si>{</span><span class=n>highest_value</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;With the lowest sales is in </span><span class=si>{</span><span class=n>lowest_year</span><span class=si>}</span><span class=s2>, generating: $</span><span class=si>{</span><span class=n>lowest_value</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=task-2>Task 2<a hidden class=anchor aria-hidden=true href=#task-2>#</a></h4><p>Q: What was the best month for sales? How much was earned that month?
A: Create Monthly Sales summary and find largest/smallest values in Monthly Sales</p><p>In this section clean_sales_df will be referred to find monthly sales as monthly_sales_df. Plot the monthly_sales_df and find largest/smallest values in monthly_sales_df then print the result as conclusion.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19>19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20>20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21>21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22>22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23>23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24>24</a>
</span><span class=lnt id=hl-7-25><a class=lnlinks href=#hl-7-25>25</a>
</span><span class=lnt id=hl-7-26><a class=lnlinks href=#hl-7-26>26</a>
</span><span class=lnt id=hl-7-27><a class=lnlinks href=#hl-7-27>27</a>
</span><span class=lnt id=hl-7-28><a class=lnlinks href=#hl-7-28>28</a>
</span><span class=lnt id=hl-7-29><a class=lnlinks href=#hl-7-29>29</a>
</span><span class=lnt id=hl-7-30><a class=lnlinks href=#hl-7-30>30</a>
</span><span class=lnt id=hl-7-31><a class=lnlinks href=#hl-7-31>31</a>
</span><span class=lnt id=hl-7-32><a class=lnlinks href=#hl-7-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find monthly sales summary and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>monthly_sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                                        <span class=n>clean_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>month</span><span class=p>])[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>monthly_sales_df</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>monthly_sales_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{0[0]}</span><span class=s1>-</span><span class=si>{0[1]}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>monthly_sales_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;date&#39;</span>
</span></span><span class=line><span class=cl><span class=n>monthly_sales_df</span> <span class=o>=</span> <span class=n>monthly_sales_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find monthly sales average</span>
</span></span><span class=line><span class=cl><span class=n>average_monthly_sales</span> <span class=o>=</span> <span class=n>monthly_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate monthly sales visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;ggplot&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>lineplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>monthly_sales_df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_major_formatter</span><span class=p>(</span><span class=n>DateFormatter</span><span class=p>(</span><span class=s1>&#39;%y-%m&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Monthly Sales&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Date&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Sales&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>monthly_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#add axh line</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>average_monthly_sales</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>monthly_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>12</span><span class=p>],</span> <span class=n>average_monthly_sales</span><span class=o>+</span><span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Avg: $</span><span class=si>{</span><span class=n>average_monthly_sales</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>monthly_sales_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>],</span> <span class=n>monthly_sales_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;$</span><span class=si>{</span><span class=n>y</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s1>&#39;offset points&#39;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find highest month and value in monthly sales</span>
</span></span><span class=line><span class=cl><span class=n>highest_months</span> <span class=o>=</span> <span class=n>monthly_sales_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>highest_months</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>highest_months</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%B %Y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>highest_month_names</span> <span class=o>=</span> <span class=n>highest_months</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>highest_month_values</span> <span class=o>=</span> <span class=n>highest_months</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find lowest month and value in monthly sales</span>
</span></span><span class=line><span class=cl><span class=n>lowest_months</span> <span class=o>=</span> <span class=n>monthly_sales_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lowest_months</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>lowest_months</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%B %Y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lowest_month_names</span> <span class=o>=</span> <span class=n>lowest_months</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lowest_month_values</span> <span class=o>=</span> <span class=n>lowest_months</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#show result as visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;ggplot&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Highest Month: </span><span class=si>{</span><span class=n>highest_month_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>highest_month_values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Lowest Month: </span><span class=si>{</span><span class=n>lowest_month_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>lowest_month_values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Best &amp; Worst Month&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Top 3 best month:</span><span class=se>\n</span><span class=si>{</span><span class=n>highest_months</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Bottom 3 worst month:</span><span class=se>\n</span><span class=si>{</span><span class=n>lowest_months</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=task-3>Task 3<a hidden class=anchor aria-hidden=true href=#task-3>#</a></h4><p>Q: What City had the highest number of sales?
A: Create Sales by State/City and find largest/smallest values in Sales by State/City</p><p>This section separated by 2 for Sales by State and Sales by City from clean_sales_df. Purpose is to find both trend on state level and city level. Plot and find largest/smallest values in both dataframe then print the result as conclusion.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find sales by state and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>sales_by_state_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;state&#39;</span><span class=p>)[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>sales_by_state_df</span> <span class=o>=</span> <span class=n>sales_by_state_df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate sales by state visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;fivethirtyeight&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;state&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>sales_by_state_df</span> <span class=p>,</span><span class=n>palette</span><span class=o>=</span><span class=s1>&#39;husl&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Sales by State&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;State&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Sales&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sales_by_state_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;$</span><span class=si>{</span><span class=n>y</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s2>&#34;offset points&#34;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7>7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8>8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#create dictionary for state colors for use in sales by city visual</span>
</span></span><span class=line><span class=cl><span class=n>state_colors</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=n>n_states</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>sales_by_state_df</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>palette</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>color_palette</span><span class=p>(</span><span class=s1>&#39;husl&#39;</span><span class=p>,</span> <span class=n>n_colors</span><span class=o>=</span><span class=n>n_states</span><span class=p>)</span>  <span class=c1>#use same palette as previous state visual</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>state</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sales_by_state_df</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=n>state_colors</span><span class=p>[</span><span class=n>state</span><span class=p>]</span> <span class=o>=</span> <span class=n>palette</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#check the state colors</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>state_colors</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find highest month and value in sales by state</span>
</span></span><span class=line><span class=cl><span class=n>highest_state</span> <span class=o>=</span> <span class=n>sales_by_state_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>highest_state_names</span> <span class=o>=</span> <span class=n>highest_state</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>highest_state_values</span> <span class=o>=</span> <span class=n>highest_state</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find lowest month and value in sales by state</span>
</span></span><span class=line><span class=cl><span class=n>lowest_state</span> <span class=o>=</span> <span class=n>sales_by_state_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lowest_state_names</span> <span class=o>=</span> <span class=n>lowest_state</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lowest_state_values</span> <span class=o>=</span> <span class=n>lowest_state</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_list</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#show result as visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;fivethirtyeight&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Highest State: </span><span class=si>{</span><span class=n>highest_state_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>highest_state_values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Lowest State: </span><span class=si>{</span><span class=n>lowest_state_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>lowest_state_values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Best &amp; Worst State&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find sales by city and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>sales_by_city_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;state&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>])[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>sales_by_city_df</span> <span class=o>=</span> <span class=n>sales_by_city_df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#modify city named &#34;Portland&#34; before generating visual (to avoid overwrite)</span>
</span></span><span class=line><span class=cl><span class=n>sales_by_city_df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=n>sales_by_city_df</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;ME&#39;</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>sales_by_city_df</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Portland&#39;</span><span class=p>),</span> <span class=s1>&#39;city&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;Portland (Maine)&#39;</span>
</span></span><span class=line><span class=cl><span class=n>sales_by_city_df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=n>sales_by_city_df</span><span class=p>[</span><span class=s1>&#39;state&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;OR&#39;</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>sales_by_city_df</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Portland&#39;</span><span class=p>),</span> <span class=s1>&#39;city&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;Portland (Oregon)&#39;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Top 3 best state sales:</span><span class=se>\n</span><span class=si>{</span><span class=n>highest_state</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Bottom 3 worst state sales:</span><span class=se>\n</span><span class=si>{</span><span class=n>lowest_state</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#generate visual for sales by city</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;fivethirtyeight&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;city&#39;</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s1>&#39;state&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>sales_by_city_df</span><span class=p>,</span> <span class=n>dodge</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=n>state_colors</span><span class=p>)</span> <span class=c1>#previous state_colors dict</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Sales by City&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Sales&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;City&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;State&#34;</span><span class=p>,</span> <span class=n>bbox_to_anchor</span><span class=o>=</span><span class=p>(</span><span class=mf>1.05</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>),</span> <span class=n>loc</span><span class=o>=</span><span class=s1>&#39;center left&#39;</span><span class=p>,</span> <span class=n>borderaxespad</span><span class=o>=</span><span class=mf>0.</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>y</span><span class=p>,</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>sales_by_city_df</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;$</span><span class=si>{</span><span class=n>x</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s1>&#39;offset points&#39;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find highest month and value in sales by city</span>
</span></span><span class=line><span class=cl><span class=n>highest_city</span> <span class=o>=</span> <span class=n>sales_by_city_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>highest_city_names</span> <span class=o>=</span> <span class=n>highest_city</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>highest_city_values</span> <span class=o>=</span> <span class=n>highest_city</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find lowest month and value in sales by city</span>
</span></span><span class=line><span class=cl><span class=n>lowest_city</span> <span class=o>=</span> <span class=n>sales_by_city_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lowest_city_names</span> <span class=o>=</span> <span class=n>lowest_city</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>lowest_city_values</span> <span class=o>=</span> <span class=n>lowest_city</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#show result as visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;fivethirtyeight&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Highest City: </span><span class=si>{</span><span class=n>highest_city_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>highest_city_values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Lowest City: </span><span class=si>{</span><span class=n>lowest_city_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Total Sales: $</span><span class=si>{</span><span class=n>lowest_city_values</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Highest &amp; Lowest City Sales&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Top 3 best city sales:</span><span class=se>\n</span><span class=si>{</span><span class=n>highest_city</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Bottom 3 worst city sales:</span><span class=se>\n</span><span class=si>{</span><span class=n>lowest_city</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=task-4>Task 4<a hidden class=anchor aria-hidden=true href=#task-4>#</a></h4><p>Q: What time should we display adverstisement to maximize likelihood of customer&rsquo;s buying product?
A: Find Monthly/Daily/Hourly Order Trend</p><p>This section will find the data related to orders by simply find count/unique number of order_id by month/day/hour. The data that will be referred here is clean_sales_2019_df(which also apply for the rest of the analysis).</p><p>Despite order id cannot be duplicate in the dataset there is multiple rows with the same order id. The reason why it&rsquo;s not dropped is because each may contains different product. *not sure how to approach/may also need to change data cleaning section</p><p>But using .count() it will return the duplicated order id as well. If we want to count the order id as unique number then we can call .nunique() which will be used in following sections.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17>17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18>18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19>19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20>20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21>21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22>22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23>23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24>24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25>25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26>26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27>27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28>28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29>29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30>30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31>31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find monthly order and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>monthly_order_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=n>clean_sales_2019_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                                             <span class=n>clean_sales_2019_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>month</span><span class=p>])[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>monthly_order_df</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>monthly_order_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{0[0]}</span><span class=s1>-</span><span class=si>{0[1]}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>monthly_order_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;date&#39;</span>
</span></span><span class=line><span class=cl><span class=n>monthly_order_df</span> <span class=o>=</span> <span class=n>monthly_order_df</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>})</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find average monthly order</span>
</span></span><span class=line><span class=cl><span class=n>average_monthly_order</span> <span class=o>=</span> <span class=n>monthly_order_df</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate monthly order visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;bmh&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>lineplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;total_orders&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>monthly_order_df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>gca</span><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_major_formatter</span><span class=p>(</span><span class=n>DateFormatter</span><span class=p>(</span><span class=s1>&#39;%Y-%m&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Monthly Order Trend&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Date&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Order&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>monthly_order_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#add axh line</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>average_monthly_order</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>monthly_order_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>12</span><span class=p>],</span> <span class=n>average_monthly_order</span><span class=o>+</span><span class=mi>5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Avg: </span><span class=si>{</span><span class=n>average_monthly_order</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>monthly_order_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>],</span> <span class=n>monthly_order_df</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s1>&#39;offset points&#39;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find 3 highest value in monthly order</span>
</span></span><span class=line><span class=cl><span class=n>highest_monthly_orders</span> <span class=o>=</span> <span class=n>monthly_order_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>highest_monthly_orders</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>highest_monthly_orders</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find 3 lowest value in monthly order</span>
</span></span><span class=line><span class=cl><span class=n>lowest_monthly_orders</span> <span class=o>=</span> <span class=n>monthly_order_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>lowest_monthly_orders</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>lowest_monthly_orders</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Months with highest total orders:</span><span class=se>\n</span><span class=si>{</span><span class=n>highest_monthly_orders</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Months with lowest total orders:</span><span class=se>\n</span><span class=si>{</span><span class=n>lowest_monthly_orders</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;*use as references to maximize/prioritize advertisement&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28>28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29>29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find daily order and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>daily_order_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>dayofweek</span><span class=p>)[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>daily_order_df</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>daily_order_df</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Monday&#39;</span><span class=p>,</span> <span class=s1>&#39;Tuesday&#39;</span><span class=p>,</span> <span class=s1>&#39;Wednesday&#39;</span><span class=p>,</span> <span class=s1>&#39;Thursday&#39;</span><span class=p>,</span> <span class=s1>&#39;Friday&#39;</span><span class=p>,</span> <span class=s1>&#39;Saturday&#39;</span><span class=p>,</span> <span class=s1>&#39;Sunday&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>daily_order_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;day_of_week&#39;</span>
</span></span><span class=line><span class=cl><span class=n>daily_order_df</span> <span class=o>=</span> <span class=n>daily_order_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find average daily order</span>
</span></span><span class=line><span class=cl><span class=n>average_daily_order</span> <span class=o>=</span> <span class=n>daily_order_df</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate daily order visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;bmh&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>lineplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;day_of_week&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;total_orders&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>daily_order_df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Daily Order Trend&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Day of Week&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Order&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add axh line</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>average_daily_order</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>daily_order_df</span><span class=p>[</span><span class=s1>&#39;day_of_week&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>7</span><span class=p>],</span> <span class=n>average_daily_order</span><span class=o>-</span><span class=mi>5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Avg: </span><span class=si>{</span><span class=n>average_daily_order</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;top&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>daily_order_df</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s1>&#39;offset points&#39;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find 3 highest value in daily orders</span>
</span></span><span class=line><span class=cl><span class=n>highest_daily_orders</span> <span class=o>=</span> <span class=n>daily_order_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find 3 lowest value in daily orders</span>
</span></span><span class=line><span class=cl><span class=n>lowest_daily_orders</span> <span class=o>=</span> <span class=n>daily_order_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Days with highest total orders:</span><span class=se>\n</span><span class=si>{</span><span class=n>highest_daily_orders</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Days with lowest total orders:</span><span class=se>\n</span><span class=si>{</span><span class=n>lowest_daily_orders</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;*use as references to maximize/prioritize advertisement&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26>26</a>
</span><span class=lnt id=hl-22-27><a class=lnlinks href=#hl-22-27>27</a>
</span><span class=lnt id=hl-22-28><a class=lnlinks href=#hl-22-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find hourly order and convert to dataframe</span>
</span></span><span class=line><span class=cl><span class=n>hourly_order_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>hour</span><span class=p>)[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>hourly_order_df</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>hourly_order_df</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>hourly_order_df</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;%H&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%H:%M&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>hourly_order_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;hour&#39;</span>
</span></span><span class=line><span class=cl><span class=n>hourly_order_df</span> <span class=o>=</span> <span class=n>hourly_order_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find average hourly order</span>
</span></span><span class=line><span class=cl><span class=n>average_hourly_order</span> <span class=o>=</span> <span class=n>hourly_order_df</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate hourly order visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;bmh&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>lineplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;hour&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;total_orders&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>hourly_order_df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Hourly Order Trend&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Hour&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Order&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add axh line</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>average_hourly_order</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>average_hourly_order</span><span class=o>+</span><span class=mi>100</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;Avg: </span><span class=si>{</span><span class=n>average_hourly_order</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>hourly_order_df</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>y</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s1>&#39;offset points&#39;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find 6 highest value in hourly orders</span>
</span></span><span class=line><span class=cl><span class=n>highest_hourly_orders</span> <span class=o>=</span> <span class=n>hourly_order_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find 6 lowest value in hourly orders</span>
</span></span><span class=line><span class=cl><span class=n>lowest_hourly_orders</span> <span class=o>=</span> <span class=n>hourly_order_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=s1>&#39;total_orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Hours with highest total orders:</span><span class=se>\n</span><span class=si>{</span><span class=n>highest_hourly_orders</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Hours with lowest total orders:</span><span class=se>\n</span><span class=si>{</span><span class=n>lowest_hourly_orders</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;*use as references to maximize/prioritize advertisement&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=task-5>Task 5<a hidden class=anchor aria-hidden=true href=#task-5>#</a></h4><p>Q: What product sold the most? Why do you think it sold the most?
A: Find Products Popularity and Product Price List Comparision</p><p>Find data related to Product Popularity by calculate sum of quantity by each product. This return the total product being purchased. It also find price list by product which is used to create filled lines for comparision.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17>17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18>18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19>19</a>
</span><span class=lnt id=hl-24-20><a class=lnlinks href=#hl-24-20>20</a>
</span><span class=lnt id=hl-24-21><a class=lnlinks href=#hl-24-21>21</a>
</span><span class=lnt id=hl-24-22><a class=lnlinks href=#hl-24-22>22</a>
</span><span class=lnt id=hl-24-23><a class=lnlinks href=#hl-24-23>23</a>
</span><span class=lnt id=hl-24-24><a class=lnlinks href=#hl-24-24>24</a>
</span><span class=lnt id=hl-24-25><a class=lnlinks href=#hl-24-25>25</a>
</span><span class=lnt id=hl-24-26><a class=lnlinks href=#hl-24-26>26</a>
</span><span class=lnt id=hl-24-27><a class=lnlinks href=#hl-24-27>27</a>
</span><span class=lnt id=hl-24-28><a class=lnlinks href=#hl-24-28>28</a>
</span><span class=lnt id=hl-24-29><a class=lnlinks href=#hl-24-29>29</a>
</span><span class=lnt id=hl-24-30><a class=lnlinks href=#hl-24-30>30</a>
</span><span class=lnt id=hl-24-31><a class=lnlinks href=#hl-24-31>31</a>
</span><span class=lnt id=hl-24-32><a class=lnlinks href=#hl-24-32>32</a>
</span><span class=lnt id=hl-24-33><a class=lnlinks href=#hl-24-33>33</a>
</span><span class=lnt id=hl-24-34><a class=lnlinks href=#hl-24-34>34</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#create dataframe for product popularity</span>
</span></span><span class=line><span class=cl><span class=n>product_popularity_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>)[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>product_popularity_df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;product&#39;</span>
</span></span><span class=line><span class=cl><span class=n>product_popularity_df</span> <span class=o>=</span> <span class=n>product_popularity_df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=s1>&#39;quantity&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>product_popularity_df</span> <span class=o>=</span> <span class=n>product_popularity_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#create dataframe for product price</span>
</span></span><span class=line><span class=cl><span class=n>product_price_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>)[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>first</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>product_price_df</span> <span class=o>=</span> <span class=n>product_price_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#merge the two dataframes on the product column</span>
</span></span><span class=line><span class=cl><span class=n>merged_popularity_price_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>product_popularity_df</span><span class=p>,</span> <span class=n>product_price_df</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate product sales visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;classic&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=p>,</span> <span class=n>ax1</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;quantity&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>merged_popularity_price_df</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=s1>&#39;husl&#39;</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ticklabel_format</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Product Popularity&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Product&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Quantity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=n>rotation</span><span class=o>=</span><span class=mi>80</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#add data callouts</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=n>label</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>y</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>plt</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>),</span> <span class=n>textcoords</span><span class=o>=</span><span class=s2>&#34;offset points&#34;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#plot product prices as filled line plot</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>twinx</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>],</span> <span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>&#34;Price&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ax2</span><span class=o>.</span><span class=n>fill_between</span><span class=p>(</span><span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>],</span> <span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>],</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2>2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3>3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4>4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5>5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6>6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7>7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8>8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#create dictionary for product colors for use in product related visual</span>
</span></span><span class=line><span class=cl><span class=n>product_colors</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=n>n_products</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>palette</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>color_palette</span><span class=p>(</span><span class=s1>&#39;husl&#39;</span><span class=p>,</span> <span class=n>n_colors</span><span class=o>=</span><span class=n>n_products</span><span class=p>)</span>  <span class=c1>#use same palette as previous product visual</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>product</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>merged_popularity_price_df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=n>product_colors</span><span class=p>[</span><span class=n>product</span><span class=p>]</span> <span class=o>=</span> <span class=n>palette</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#check the state colors</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>product_colors</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span><span class=lnt id=hl-26-11><a class=lnlinks href=#hl-26-11>11</a>
</span><span class=lnt id=hl-26-12><a class=lnlinks href=#hl-26-12>12</a>
</span><span class=lnt id=hl-26-13><a class=lnlinks href=#hl-26-13>13</a>
</span><span class=lnt id=hl-26-14><a class=lnlinks href=#hl-26-14>14</a>
</span><span class=lnt id=hl-26-15><a class=lnlinks href=#hl-26-15>15</a>
</span><span class=lnt id=hl-26-16><a class=lnlinks href=#hl-26-16>16</a>
</span><span class=lnt id=hl-26-17><a class=lnlinks href=#hl-26-17>17</a>
</span><span class=lnt id=hl-26-18><a class=lnlinks href=#hl-26-18>18</a>
</span><span class=lnt id=hl-26-19><a class=lnlinks href=#hl-26-19>19</a>
</span><span class=lnt id=hl-26-20><a class=lnlinks href=#hl-26-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find product sold most</span>
</span></span><span class=line><span class=cl><span class=n>product_sold_most</span> <span class=o>=</span> <span class=n>merged_popularity_price_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>product_sold_most_names</span> <span class=o>=</span> <span class=n>product_sold_most</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>product_sold_most_quantities</span> <span class=o>=</span> <span class=n>product_sold_most</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find product sold least</span>
</span></span><span class=line><span class=cl><span class=n>product_sold_least</span> <span class=o>=</span> <span class=n>merged_popularity_price_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>product_sold_least_names</span> <span class=o>=</span> <span class=n>product_sold_least</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>product_sold_least_quantities</span> <span class=o>=</span> <span class=n>product_sold_least</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#show result as visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;classic&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Most sold: </span><span class=si>{</span><span class=n>product_sold_most_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Quantity: </span><span class=si>{</span><span class=n>product_sold_most_quantities</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Least sold: </span><span class=si>{</span><span class=n>product_sold_least_names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, Quantity: </span><span class=si>{</span><span class=n>product_sold_least_quantities</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Most &amp; Least Sold Product&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2>2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3>3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4>4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Top 3 most sold products:</span><span class=se>\n</span><span class=si>{</span><span class=n>product_sold_most</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Bottom 3 least sold products:</span><span class=se>\n</span><span class=si>{</span><span class=n>product_sold_least</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1> 1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2> 2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3> 3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4> 4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5> 5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6> 6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7> 7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8> 8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9> 9</a>
</span><span class=lnt id=hl-28-10><a class=lnlinks href=#hl-28-10>10</a>
</span><span class=lnt id=hl-28-11><a class=lnlinks href=#hl-28-11>11</a>
</span><span class=lnt id=hl-28-12><a class=lnlinks href=#hl-28-12>12</a>
</span><span class=lnt id=hl-28-13><a class=lnlinks href=#hl-28-13>13</a>
</span><span class=lnt id=hl-28-14><a class=lnlinks href=#hl-28-14>14</a>
</span><span class=lnt id=hl-28-15><a class=lnlinks href=#hl-28-15>15</a>
</span><span class=lnt id=hl-28-16><a class=lnlinks href=#hl-28-16>16</a>
</span><span class=lnt id=hl-28-17><a class=lnlinks href=#hl-28-17>17</a>
</span><span class=lnt id=hl-28-18><a class=lnlinks href=#hl-28-18>18</a>
</span><span class=lnt id=hl-28-19><a class=lnlinks href=#hl-28-19>19</a>
</span><span class=lnt id=hl-28-20><a class=lnlinks href=#hl-28-20>20</a>
</span><span class=lnt id=hl-28-21><a class=lnlinks href=#hl-28-21>21</a>
</span><span class=lnt id=hl-28-22><a class=lnlinks href=#hl-28-22>22</a>
</span><span class=lnt id=hl-28-23><a class=lnlinks href=#hl-28-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find price for each item list</span>
</span></span><span class=line><span class=cl><span class=n>product_list_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>)[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>first</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>product_list_df</span> <span class=o>=</span> <span class=n>product_list_df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=s1>&#39;price&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>product_list_df</span> <span class=o>=</span> <span class=n>product_list_df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find product price average</span>
</span></span><span class=line><span class=cl><span class=n>average_product_price</span> <span class=o>=</span> <span class=n>product_list_df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate product list visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;classic&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s1>&#39;price&#39;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>product_list_df</span><span class=p>,</span> <span class=n>palette</span><span class=o>=</span><span class=n>product_colors</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Product Price List&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Price&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Product&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#add axv line</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>average_product_price</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>average_product_price</span><span class=o>+</span><span class=mi>5</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>product_list_df</span><span class=p>)</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;Avg: $</span><span class=si>{</span><span class=n>average_product_price</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find expensive product</span>
</span></span><span class=line><span class=cl><span class=n>most_expensive_product</span> <span class=o>=</span> <span class=n>product_list_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find cheap product</span>
</span></span><span class=line><span class=cl><span class=n>most_cheap_product</span> <span class=o>=</span> <span class=n>product_list_df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Most expensive products:</span><span class=se>\n</span><span class=si>{</span><span class=n>most_expensive_product</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;Most cheap products:</span><span class=se>\n</span><span class=si>{</span><span class=n>most_cheap_product</span><span class=o>.</span><span class=n>to_string</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find average quantity per order id</span>
</span></span><span class=line><span class=cl><span class=n>average_item_per_order</span> <span class=o>=</span> <span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;order_id&#39;</span><span class=p>)[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#show result as visual</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;classic&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>average_item_per_order</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>fontsize</span><span class=o>=</span><span class=mi>40</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Average Item Each Order&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=task-6>Task 6<a hidden class=anchor aria-hidden=true href=#task-6>#</a></h4><p>Q: How much probability for next people will order certain products?
A: Find Product Orders % of Total Sales</p><p>The following section is to find % product orders/sold compare to the total sales of all products. the result will give % of product which may define the likelihood of the product will be purchased next. This part is also the only section which used Squarify to plot the result as Treemap.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1> 1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2> 2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3> 3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4> 4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5> 5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6> 6</a>
</span><span class=lnt id=hl-31-7><a class=lnlinks href=#hl-31-7> 7</a>
</span><span class=lnt id=hl-31-8><a class=lnlinks href=#hl-31-8> 8</a>
</span><span class=lnt id=hl-31-9><a class=lnlinks href=#hl-31-9> 9</a>
</span><span class=lnt id=hl-31-10><a class=lnlinks href=#hl-31-10>10</a>
</span><span class=lnt id=hl-31-11><a class=lnlinks href=#hl-31-11>11</a>
</span><span class=lnt id=hl-31-12><a class=lnlinks href=#hl-31-12>12</a>
</span><span class=lnt id=hl-31-13><a class=lnlinks href=#hl-31-13>13</a>
</span><span class=lnt id=hl-31-14><a class=lnlinks href=#hl-31-14>14</a>
</span><span class=lnt id=hl-31-15><a class=lnlinks href=#hl-31-15>15</a>
</span><span class=lnt id=hl-31-16><a class=lnlinks href=#hl-31-16>16</a>
</span><span class=lnt id=hl-31-17><a class=lnlinks href=#hl-31-17>17</a>
</span><span class=lnt id=hl-31-18><a class=lnlinks href=#hl-31-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#find total product sold</span>
</span></span><span class=line><span class=cl><span class=n>total_product_sold</span> <span class=o>=</span> <span class=n>product_popularity_df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find sizes and labels value in product popularity</span>
</span></span><span class=line><span class=cl><span class=n>sizes</span> <span class=o>=</span> <span class=n>product_popularity_df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>labels</span> <span class=o>=</span> <span class=n>product_popularity_df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#calculate percentage for each product</span>
</span></span><span class=line><span class=cl><span class=n>percentages</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=mi>100</span><span class=o>*</span><span class=n>sizes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>/</span><span class=n>sizes</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>%</span><span class=se>\n</span><span class=si>{</span><span class=n>labels</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>sizes</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate treemap visual for product sold percentage of total</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>plt</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>context</span><span class=p>(</span><span class=s1>&#39;seaborn-dark-palette&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>squarify</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>sizes</span><span class=o>=</span><span class=n>sizes</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=n>percentages</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=n>color</span><span class=o>=</span><span class=p>[</span><span class=n>product_colors</span><span class=p>[</span><span class=n>label</span><span class=p>]</span> <span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=n>labels</span><span class=p>])</span> <span class=c1>#get color from previous product color dict</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&#34;Product </span><span class=si>% o</span><span class=s2>f Total&#34;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2>2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3>3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4>4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5>5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6>6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7>7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#print the result as conclusion</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=sa>f</span><span class=s2>&#34;List of probability:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#find percentages for product and print as conclusion</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>percentages</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>prob</span><span class=p>,</span> <span class=n>label</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2> = </span><span class=si>{</span><span class=n>prob</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=task-7>Task 7<a hidden class=anchor aria-hidden=true href=#task-7>#</a></h4><p>Q: What products are most often sold together?
A: Find Product Associate Rules using mlxtend library</p><p>First need to find the product sold by each order id and store them into series(product_by_order). Then transform the data into one-hot encoded matrix by applying TransactionEncoder().fit_transform(). The result will be stored as dataframe(encoded_df). Encoded data then used to generate frequent item sets using apriori algorithm the minimum support are defined as following. Lastly sort the order by value in &lsquo;confidence&rsquo;.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span><span class=lnt id=hl-33-12><a class=lnlinks href=#hl-33-12>12</a>
</span><span class=lnt id=hl-33-13><a class=lnlinks href=#hl-33-13>13</a>
</span><span class=lnt id=hl-33-14><a class=lnlinks href=#hl-33-14>14</a>
</span><span class=lnt id=hl-33-15><a class=lnlinks href=#hl-33-15>15</a>
</span><span class=lnt id=hl-33-16><a class=lnlinks href=#hl-33-16>16</a>
</span><span class=lnt id=hl-33-17><a class=lnlinks href=#hl-33-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#group product by order id</span>
</span></span><span class=line><span class=cl><span class=n>product_by_order</span> <span class=o>=</span> <span class=n>clean_sales_2019_df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;order_id&#39;</span><span class=p>)[</span><span class=s1>&#39;product&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#convert data to one-hot encoded matrix</span>
</span></span><span class=line><span class=cl><span class=n>te</span> <span class=o>=</span> <span class=n>TransactionEncoder</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>onehot</span> <span class=o>=</span> <span class=n>te</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>product_by_order</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>encoded_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>onehot</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=n>te</span><span class=o>.</span><span class=n>columns_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#identify frequent itemsets</span>
</span></span><span class=line><span class=cl><span class=n>frequent_itemsets</span> <span class=o>=</span> <span class=n>apriori</span><span class=p>(</span><span class=n>encoded_df</span><span class=p>,</span> <span class=n>min_support</span><span class=o>=</span><span class=mf>0.000015</span><span class=p>,</span> <span class=n>use_colnames</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#generate association rules</span>
</span></span><span class=line><span class=cl><span class=n>rules</span> <span class=o>=</span> <span class=n>association_rules</span><span class=p>(</span><span class=n>frequent_itemsets</span><span class=p>,</span> <span class=n>metric</span><span class=o>=</span><span class=s1>&#39;confidence&#39;</span><span class=p>,</span> <span class=n>min_threshold</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rules</span> <span class=o>=</span> <span class=n>rules</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;confidence&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print rules data head</span>
</span></span><span class=line><span class=cl><span class=n>rules</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Although the rules can be presented as tables. In this case the rules is generated as string following more descriptive explanation. There may be other method to visualize the rules waiting to be explored. But for now the following will do.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span><span class=lnt id=hl-34-14><a class=lnlinks href=#hl-34-14>14</a>
</span><span class=lnt id=hl-34-15><a class=lnlinks href=#hl-34-15>15</a>
</span><span class=lnt id=hl-34-16><a class=lnlinks href=#hl-34-16>16</a>
</span><span class=lnt id=hl-34-17><a class=lnlinks href=#hl-34-17>17</a>
</span><span class=lnt id=hl-34-18><a class=lnlinks href=#hl-34-18>18</a>
</span><span class=lnt id=hl-34-19><a class=lnlinks href=#hl-34-19>19</a>
</span><span class=lnt id=hl-34-20><a class=lnlinks href=#hl-34-20>20</a>
</span><span class=lnt id=hl-34-21><a class=lnlinks href=#hl-34-21>21</a>
</span><span class=lnt id=hl-34-22><a class=lnlinks href=#hl-34-22>22</a>
</span><span class=lnt id=hl-34-23><a class=lnlinks href=#hl-34-23>23</a>
</span><span class=lnt id=hl-34-24><a class=lnlinks href=#hl-34-24>24</a>
</span><span class=lnt id=hl-34-25><a class=lnlinks href=#hl-34-25>25</a>
</span><span class=lnt id=hl-34-26><a class=lnlinks href=#hl-34-26>26</a>
</span><span class=lnt id=hl-34-27><a class=lnlinks href=#hl-34-27>27</a>
</span><span class=lnt id=hl-34-28><a class=lnlinks href=#hl-34-28>28</a>
</span><span class=lnt id=hl-34-29><a class=lnlinks href=#hl-34-29>29</a>
</span><span class=lnt id=hl-34-30><a class=lnlinks href=#hl-34-30>30</a>
</span><span class=lnt id=hl-34-31><a class=lnlinks href=#hl-34-31>31</a>
</span><span class=lnt id=hl-34-32><a class=lnlinks href=#hl-34-32>32</a>
</span><span class=lnt id=hl-34-33><a class=lnlinks href=#hl-34-33>33</a>
</span><span class=lnt id=hl-34-34><a class=lnlinks href=#hl-34-34>34</a>
</span><span class=lnt id=hl-34-35><a class=lnlinks href=#hl-34-35>35</a>
</span><span class=lnt id=hl-34-36><a class=lnlinks href=#hl-34-36>36</a>
</span><span class=lnt id=hl-34-37><a class=lnlinks href=#hl-34-37>37</a>
</span><span class=lnt id=hl-34-38><a class=lnlinks href=#hl-34-38>38</a>
</span><span class=lnt id=hl-34-39><a class=lnlinks href=#hl-34-39>39</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#create summary for each rule</span>
</span></span><span class=line><span class=cl><span class=c1>#create list to store items</span>
</span></span><span class=line><span class=cl><span class=n>summaries</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#iterrate throught available items in rules</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>rules</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>antecedents</span> <span class=o>=</span> <span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;antecedents&#39;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=n>consequents</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;consequents&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>support</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;support&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>confidence</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;confidence&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>lift</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;lift&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>leverage</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;leverage&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>conviction</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;conviction&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>#define ANSI escape codes for modifying the text&#39;s appearance</span>
</span></span><span class=line><span class=cl>    <span class=n>BLUE</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[94m&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>GREEN</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[92m&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>RED</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\033</span><span class=s2>[91m&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>END</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=se>\033</span><span class=s1>[0m&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#create summary in string</span>
</span></span><span class=line><span class=cl>    <span class=n>summary</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Rule </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Customers who bought </span><span class=si>{</span><span class=n>BLUE</span><span class=si>}{</span><span class=n>antecedents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> are more likely to buy </span><span class=si>{</span><span class=n>RED</span><span class=si>}{</span><span class=n>consequents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2>.</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;This combination of products was purchased in </span><span class=si>{</span><span class=n>GREEN</span><span class=si>}{</span><span class=n>support</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>%</span><span class=si>{</span><span class=n>END</span><span class=si>}</span><span class=s2> of all transactions.</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;When customers buy </span><span class=si>{</span><span class=n>BLUE</span><span class=si>}{</span><span class=n>antecedents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2>, the chance of them also buying </span><span class=si>{</span><span class=n>RED</span><span class=si>}{</span><span class=n>consequents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> is </span><span class=si>{</span><span class=n>GREEN</span><span class=si>}{</span><span class=n>confidence</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%</span><span class=si>{</span><span class=n>END</span><span class=si>}</span><span class=s2>.</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>RED</span><span class=si>}{</span><span class=n>consequents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> appears </span><span class=si>{</span><span class=n>GREEN</span><span class=si>}{</span><span class=n>lift</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>x</span><span class=si>{</span><span class=n>END</span><span class=si>}</span><span class=s2> more likely when </span><span class=si>{</span><span class=n>BLUE</span><span class=si>}{</span><span class=n>antecedents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> appears compared to </span><span class=si>{</span><span class=n>RED</span><span class=si>}{</span><span class=n>consequents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> alone in general.</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;The rule&#39;s significance, as measured by leverage, is </span><span class=si>{</span><span class=n>GREEN</span><span class=si>}{</span><span class=n>leverage</span><span class=si>:</span><span class=s2>.5f</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2>.</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Dependence between </span><span class=si>{</span><span class=n>BLUE</span><span class=si>}{</span><span class=n>antecedents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> and </span><span class=si>{</span><span class=n>RED</span><span class=si>}{</span><span class=n>consequents</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2> is </span><span class=si>{</span><span class=n>GREEN</span><span class=si>}{</span><span class=n>conviction</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}{</span><span class=n>END</span><span class=si>}</span><span class=s2>.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#append the summary</span>
</span></span><span class=line><span class=cl>    <span class=n>summaries</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>summary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#join all summaries into a single string</span>
</span></span><span class=line><span class=cl><span class=n>summary_string</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>summaries</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#print summary</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CONCLUSION</span><span class=se>\n\n</span><span class=si>{</span><span class=n>summary_string</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=summarize>Summarize<a hidden class=anchor aria-hidden=true href=#summarize>#</a></h2><p>It appears that the company generated a total of USD 34,465,537.94 in sales, with the majority of sales occurring in 2019, totaling USD 34,456,867.65. In contrast, 2020 only accounted for USD 8,670.29 in sales, which may be due to incomplete or missing data. The highest selling months were December, October, and April 2019, with sales of USD 4,608,295.70, USD 3,734,777.86 and USD 3,389,217.98 respectively, while the lowest sales occurred in January, September 2019, and January 2020, which accounted for only USD 3,915,878.85 of the total sales. The company generated the highest sales in California (CA), with San Francisco and Los Angeles accounting for USD 8,254,743.55 and USD 5,448,304.28 respectively. The lowest sales occurred in Portland, Maine, with only USD 449,321.38 in sales.</p><p>To maximize the company&rsquo;s advertising efforts, it is recommended to advertise in December, October, and April, as the company generated the most orders during these months (24,004, 19,436, and 17,528, respectively). Tuesdays were found to be the most profitable day for advertising, generating 26,063 orders, while Fridays had the lowest number of orders. The best times for advertising were between 11:00-13:00 and 18:00-20:00, when the company typically had the highest sales counts.</p><p>In terms of product performance, some products performed better or worse than their price indicated. The finding result is as following:</p><p>The Bose SoundSport Headphones had a lower price, but sold less than the Apple Airpods Headphones.
The 34in Ultrawide Monitor, 27in 4K Gaming Monitor, Flatscreen TV, 20in Monitor, Vareebadd Phone, LG Washing Machine, and LG Dryer all sold fewer units than the iPhone despite having lower prices.
In contrast, the ThinkPad Laptop and Macbook Pro Laptop performed better than expected when compared to the LG Dryer, LG Washing Machine, Vareebadd Phone, and 20in Monitor despite having higher price.
The 20in Monitor was the worst-performing product, selling only 4,123 units, compared to the 27in FHD Monitor, which sold 7,538 units despite having lower price.
Finally, the probability of customers ordering specific products compared to all other products was calculated as following:</p><p>The USB-C Charging Cable had the highest probability, with 11.46%.
Followed by the Wired Headphones at 9.83%.
The iPhone had a probability of 3.28%.
While the Google Phone had a probability of 2.65%.
Additionally, when customers bought Apple Airpods Headphones, Wired Headphones, and Lightning Charging Cable, the chance of them also buying an iPhone was 100%, but this accounted for only 0.002% of total transactions. Similarly, when customers bought Wired Headphones, USB-C Charging Cable, and Bose SoundSport Headphones, the chance of them also buying a Google Phone was 60%, but this accounted for only 0.002% of total transactions.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=/data.csv>Dataset</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://httplife.com/tags/data-analysis/>Data Analysis</a></li><li><a href=https://httplife.com/tags/python/>Python</a></li><li><a href=https://httplife.com/tags/reactjs/>ReactJS</a></li></ul><nav class=paginav><a class=next href=https://httplife.com/projects/hate-crime-tracker/><span class=title>Next »</span><br><span>Hate Crime Tracker</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://httplife.com/>HTTPLIFE</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>